<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>St. Jude Rust Labs RFCs</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">St. Jude Rust Labs RFCs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <img style="margin: 0px" alt="Repository Header Image" src="./resources/repo-header.png" />
<h1 id="requests-for-comments-for-the-st-jude-rust-labs-project"><a class="header" href="#requests-for-comments-for-the-st-jude-rust-labs-project">Requests For Comments for the St. Jude Rust Labs project</a></h1>
<p>This repo structure and contents are <del>stolen</del> borrowed from the <a href="https://github.com/stjudecloud/rfcs">St. Jude Cloud Team's <code>rfcs</code> repo</a>.</p>
<p>RFC template is largely <del>stolen</del> inspired by the <a href="https://github.com/rust-lang/rfcs/blob/master/0000-template.md">rust-lang template</a></p>
<h2 id="install"><a class="header" href="#install">Install</a></h2>
<pre><code class="language-sh">cargo install mdbook
</code></pre>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<pre><code class="language-sh">mdbook build
python3 -m http.server -d book
# visit the rendered version in your browser at http://localhost:8000.
</code></pre>
<h2 id="-license-and-legal"><a class="header" href="#-license-and-legal">üìù License and Legal</a></h2>
<p>This project is licensed as either <a href="https://github.com/stjude-rust-labs/rfcs/blob/main/LICENSE-APACHE">Apache 2.0</a> or
<a href="https://github.com/stjude-rust-labs/rfcs/blob/main/LICENSE-MIT">MIT</a> at your discretion. Additionally, please see <a href="https://github.com/stjude-rust-labs#disclaimer">the
disclaimer</a> that applies to all
crates and command line tools made available by St. Jude Rust Labs.</p>
<p>Copyright ¬© 2023-Present <a href="https://github.com/stjude">St. Jude Children's Research Hospital</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="placeholder"><a class="header" href="#placeholder">Placeholder</a></h1>
<p>We need a document here for the build, but there are not currently any "accepted" RFCs.</p>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>Feature Name: sprocket-test</li>
<li>Start Date: 2025-08</li>
</ul>
<h1 id="summary"><a class="header" href="#summary">Summary</a></h1>
<p>The Sprocket test framework enables WDL authors to easily and comprehensively validate their WDL tasks and workflows by defining lightweight unit tests that can run in CI environments. This framework is intended to be intuitive and concise.</p>
<p>This framework can maximize test depth without adding boilerplate by allowing users to define "test matrices", where each WDL task or workflow is run with permutations of the provided inputs.</p>
<h1 id="motivation"><a class="header" href="#motivation">Motivation</a></h1>
<p>Comprehensive unit testing is a key component of modern software development. Any serious project should endeavor to have a suite of tests that ensure code correctness. These tests should be lightweight enough to run during continuous integration on every set of committed changes. (This RFC is primarily focused on CI unit testing, but enabling larger scale "end-to-end" testing is something that should be kept in mind during this design process. That said, I'm of the opinion these are separate enough use cases that they can be approached with differing APIs, and thus decisions made here should not impact any future E2E testing API too heavily.)</p>
<h1 id="guide-level-explanation"><a class="header" href="#guide-level-explanation">Guide-level explanation</a></h1>
<p>The Sprocket test framework is primarily specified in TOML, which is expected to be within a <code>tests/</code> directory at the root of the WDL workspace. <code>sprocket test</code> does not require any special syntax or modification of actual WDL files, and any spec-compliant WDL workspace can create a <code>tests</code> directory respected by Sprocket.</p>
<p>The <code>tests/</code> directory is expected to mirror the WDL workspace, where it should have the same path structure, but with <code>.wdl</code> file extensions replaced by <code>.toml</code> extensions. The TOML files contain tests for tasks and workflows defined at their respective WDL counterpart in the main workspace. e.g. a WDL file located at <code>data_structures/flag_filter.wdl</code> would have accompanying tests defined in <code>tests/data_structures/flag_filter.toml</code>. Following this structure frees the TOML from having to contain any information about <em>where</em> to find the entrypoints of each test. All the test entrypoints (tasks or workflows) in <code>tests/data_structures/flag_filter.toml</code> are expected to be defined in the WDL located at <code>data_structures/flag_filter.wdl</code>.</p>
<p>Any task or worklow defined in <code>data_structures/flag_filter.wdl</code> can have any number of tests associated with it in <code>tests/data_structures/flag_filter.toml</code>. To write a set of tests for a task <code>validate_string_is_12bit_int</code> in <code>flag_filter.wdl</code>, the user will define an array of tables in their TOML with the key <code>[[validate_string_is_12bit_int]]</code>. Multiple tests can be written for the <code>validate_string_is_12bit_int</code> task by repeating the <code>[[validate_string_is_12bit_int]]</code> header. The <code>validate_flag_filter</code> workflow can be tested the same way, by defining a TOML array of tables headered with <code>[[validate_flag_filter]]</code>. Under each of these headers will be a TOML table with all the required information for a single test.</p>
<p>An example TOML for specifying a suite of tests for <a href="https://github.com/stjudecloud/workflows/blob/main/data_structures/flag_filter.wdl">the <code>flag_filter.wdl</code> document in the <code>workflows</code> repo</a> would look like:</p>
<pre><code class="language-toml">[[validate_string_is_12bit_int]]
name = "decimal passes" # each test must have a unique name
[validate_string_is_12bit_int.inputs] # table of inputs
number = "5"
# without any tests explicitely configured, Sprocket will consider the task executing with a 0 exit code to be a "pass" and any non-zero exit code as a "fail"

[[validate_string_is_12bit_int]]
name = "hexadecimal passes"
[validate_string_is_12bit_int.inputs]
number = "0x900"
[validate_string_is_12bit_int.tests] # table of test conditions
exit_code = 0 # redundant and not needed explicitly
stdout.contains = "Input number (0x900) is valid" # builtin test for checking STDOUT logs

[[validate_string_is_12bit_int]]
name = "too big hexadecimal fails"
[validate_string_is_12bit_int.inputs]
number = "0x1000"
[validate_string_is_12bit_int.tests]
exit_code = 42 # the task should fail for this test
stderr.contains = "Input number (0x1000) is invalid" # similar to the stdout test

[[validate_string_is_12bit_int]]
name = "too big decimal fails"
[validate_string_is_12bit_int.inputs]
number = "4096"
[validate_string_is_12bit_int.tests]
exit_code = 42
stderr.contains = [
    "Input number (4096) interpreted as decimal",
    "But number must be less than 4096!",
] # a test which is a bit more complicated

[[validate_flag_filter]] # a workflow test
name = "Valid FlagFilter passes"
[validate_flag_filter.inputs.flags]
include_if_all = "3" # decimal
exclude_if_any = "0xF04" # hexadecimal
include_if_any = "03" # octal
exclude_if_all = "4095" # decimal

[[validate_flag_filter]]
name = "Invalid FlagFilter fails"
[validate_flag_filter.inputs.flags]
include_if_all = "" # empty string
exclude_if_any = "this is not a number"
include_if_any = "000000000011" # binary interpreted as octal. Too many digits for octal
exclude_if_all = "4095" # this is fine
[validate_flag_filter.tests]
should_fail = true
</code></pre>
<p>Hopefully, everything in the above TOML is easily enough grokked that I won't spend time going through the specifics in much detail. The <code>flag_filter.wdl</code> WDL document contains a task and a workflow, both with minimal inputs and no outputs, making the tests fairly straightforward. One of Sprocket's guiding principles is to only introduce complexity where it's warranted, and I hope that this example demonstrates a case where complexity is <em>not</em> warranted. Next, we will be discussing features intended for allowing test cases that are more complex, but the end API exposed to users (the focus of this document) still aims to maintain simplicity and inuitiveness.</p>
<h2 id="test-data"><a class="header" href="#test-data">Test Data</a></h2>
<p>Most WDL tasks and workflows have <code>File</code> type inputs and outputs, so there should be an easy way to incorporate test files into the framework. This can be accomplished with a <code>tests/fixtures/</code> directory that can be referred to from any TOML test in the <code>tests</code> directory. If the string <code>$FIXTURES</code> is found within a TOML string value within the <code>inputs</code> table, the correct path to the <code>fixtures</code> directory will be dynamically inserted at test run time. This avoids having to track relative paths from TOML that may be arbitrarily nested in relation to test data. For example, let's assume there are <code>test.bam</code>, <code>test.bam.bai</code>, and <code>referece.fa.gz</code> files located within the <code>tests/fixtures/</code> directory; the following TOML <code>inputs</code> table could be used regardless of where that acutal <code>.toml</code> file resides within the <code>tests/</code> directory:</p>
<pre><code class="language-toml">bam = "$FIXTURES/test.bam"
bam_index = "$FIXTURES/test.bam.bai"
reference_fasta = "$FIXTURES/reference.fa.gz"
</code></pre>
<h2 id="builtin-test-conditions"><a class="header" href="#builtin-test-conditions">Builtin Test Conditions</a></h2>
<p>Sprocket will support a variety of common test conditions. In this document so far, we've seen a few of the most straightforward conditions already in the <code>tests</code> table of the earlier TOML example (<code>exit_code</code>, <code>stdout.contains</code>, <code>stderr.contains</code> and <code>should_fail</code>). For the initial release of <code>sprocket test</code>, these test builtins will probably remain as a rather small and tailored set, but the implementation should make extending this set in subsequent releases simple and non-breaking.</p>
<p>Some tests that might exist at initial release:</p>
<ul>
<li><code>exit_code = &lt;int&gt;</code> (should an array of ints be supported?)</li>
<li><code>should_fail = &lt;bool&gt;</code>: only available for workflow tests! Task tests should instead specify an <code>exit_code</code></li>
<li><code>stdout</code>: will be a TOML table with a sub-tests related to checking a tasks STDOUT log (<em>not available</em> for workflow tests)
<ul>
<li><code>contains = &lt;string | array of strings&gt;</code>: strings are REs</li>
<li><code>not_contains = &lt;string | array of strings&gt;</code>: strings are REs</li>
</ul>
</li>
<li><code>stderr</code>: functionally equivalent to the <code>stdout</code> tests, but runs on the STDERR log instead</li>
<li><code>outputs</code>: a TOML table populated with task or workflow output indentifiers. The specific tests available will depend on the WDL type of the specified output
<ul>
<li><code>&lt;WDL Boolean&gt; = &lt;true|false&gt;</code></li>
<li><code>&lt;WDL Int&gt; = &lt;TOML int&gt;</code></li>
<li><code>&lt;WDL Float&gt; = &lt;TOML float&gt;</code></li>
<li><code>&lt;WDL String&gt;</code>
<ul>
<li><code>contains = &lt;string | array of strings&gt;</code>: strings are REs</li>
<li><code>not_contains = &lt;string | array of strings&gt;</code>: strings are REs</li>
<li><code>equals = &lt;string&gt;</code> an exact match RE</li>
</ul>
</li>
<li><code>&lt;WDL File&gt;</code>
<ul>
<li><code>name = &lt;string&gt;</code>: glob pattern that should match</li>
<li><code>hash = &lt;string&gt;</code>: md5 (or blake3?) that the file should have</li>
<li><code>contains = &lt;string | array of strings&gt;</code>: REs to expect (implies the file is ASCII and will fail if in another encoding)</li>
<li><code>not_contains = &lt;string | array of strings&gt;</code>: inverse of <code>contains</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The above is probably (about) sufficient for an initial release. Thoughts about future tests that could exist will be discussed further down this document.</p>
<h2 id="test-matrices"><a class="header" href="#test-matrices">Test Matrices</a></h2>
<p>Often, it makes sense to validate that a variety of inputs result in the same test result. While the TOML definitions shared so far are relatively concise, repeating the same test conditions for many different inputs can get repetitive and the act of writing redundant boilerplate can discourage testing best practices. Sprocket offers a "shortcut" for avoiding this boilerplate, by defining test matrices. These test matrices can be a way to reach comprehensive test depth with minimal boilerplate test definitions. A test matrix is created by defining a <code>matrix</code> TOML array of tables for a set of test inputs. Each permutation of the "input vectors" will be run, which can be leveraged to test many conditions with a single test definition. An example for a <code>bam_to_fastq</code> task might look like:</p>
<pre><code class="language-toml">[[bam_to_fastq]]
name = "Kitchen Sink"
[[bam_to_fastq.matrix]]
bam = [
    "$FIXTURES/test1.bam",
    "$FIXTURES/test2.bam",
    "$FIXTURES/test3.bam",
]
bam_index = [
    "$FIXTURES/test1.bam.bai",
    "$FIXTURES/test2.bam.bai",
    "$FIXTURES/test3.bam.bai",
]
[[bam_to_fastq.matrix]]
bitwise_filter = [
    { include_if_all = "0x0", exclude_if_any = "0x900", include_if_any = "0x0", exclude_if_all = "0x0" },
    { include_if_all = "00", exclude_if_any = "0x904", include_if_any = "3", exclude_if_all = "0" },
]
[[bam_to_fastq.matrix]]
paired_end = [true, false]
[[bam_to_fastq.matrix]]
retain_collated_bam = [true, false]
[[bam_to_fastq.matrix]]
append_read_number = [true, false]
[[bam_to_fastq.matrix]]
output_singletons = [true, false]
[bam_to_fastq.inputs]
prefix = "kitchen_sink_test" # the `prefix` input will be shared by _all_ permutations of the test matrix
# this test is to ensure all the options (and combinations thereof) are valid
# so no tests beyond a `0` exit code are needed here
</code></pre>
<p>This is perhaps an extreme test case, but it was contrived as a stress test of sorts for the matrix design. In ~30 lines of TOML, this defines <code>3*2*2*2*2*2 = 96</code> different permutations of the <code>bam_to_fastq</code> task that should be executed by Sprocket. This specific case may be too intense to run in a CI environment, but should demonstrate the power of test matrices in aiding comprehensive testing without undue boilerplate.</p>
<p>(Notably, the actual <code>bam_to_fastq</code> task in <code>samtools.wdl</code> (<a href="https://github.com/stjudecloud/workflows/blob/main/tools/samtools.wdl#L763">here</a>) does not have a <code>bam_index</code> input, but that was added to this example for illustrative purposes)</p>
<p>REVIEWERS: I can write more examples of "real" TOML test files, as presumably we will be switching the <code>workflows</code> repo to this framework, in which case any tests written as examples here can hopefully just be re-used with minimal modification for the production tests we want. So don't be afraid to ask for more examples! I just didn't want to overload this document ;D</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>Both of the expected paths, <code>tests/</code> and <code>fixtures/</code> within <code>tests/</code>, can be overriden via config. <code>tests/</code> conflicts with <code>pytest-workflows</code>, so users may want to rename the default Sprocket test directory to something like <code>sprocket-tests/</code>. It is unlikely that anyone will be writing WDL that needs to be tested at a <code>fixtures/</code> path, but this should also be configurable to avoid that potential clash.</p>
<h1 id="reference-level-explanation"><a class="header" href="#reference-level-explanation">Reference-level explanation</a></h1>
<p>REVIEWERS: is this section needed?</p>
<hr />
<p>This is the technical portion of the RFC. Explain the design in sufficient detail that:</p>
<ul>
<li>Its interaction with other features is clear.</li>
<li>It is reasonably clear how the feature would be implemented.</li>
<li>Corner cases are dissected by example.</li>
</ul>
<p>The section should return to the examples given in the previous section, and explain more fully how the detailed proposal makes those examples work.</p>
<h1 id="drawbacks"><a class="header" href="#drawbacks">Drawbacks</a></h1>
<p>Q: Why should we <em>not</em> do this?</p>
<p>A: <em>none!</em> This is a great idea!</p>
<p>To be serious, <code>pytest-workflows</code> seems to be the best test framework for WDL that I've been able to find as a WDL author, and as a user of that framework, I'm not happy. I have a few specific gripes I can get into, but for brevity I will avoid rambling here :)</p>
<h1 id="rationale-and-alternatives"><a class="header" href="#rationale-and-alternatives">Rationale and alternatives</a></h1>
<p>REVIEWERS: I've thought through quite a wide variety of implementations that have not made it into writing, and I'm not sure how valuable my musings on alternatives I <em>didn't like</em> are. I can expand on this section if it would be informative, but I am leaving the below questions unanswered for now.</p>
<ul>
<li>Why is this design the best in the space of possible designs?</li>
<li>What other designs have been considered and what is the rationale for not choosing them?</li>
<li>What is the impact of not doing this?</li>
</ul>
<h1 id="prior-art"><a class="header" href="#prior-art">Prior art</a></h1>
<p>Discuss prior art, both the good and the bad, in relation to this proposal.</p>
<p>TODO(Ari): populate this with some links to existing frameworks and add some basic comments on them</p>
<h1 id="future-possibilities"><a class="header" href="#future-possibilities">Future possibilities</a></h1>
<p>I think there's a lot of room for growth in the builtin test conditions. This document just has what I think are about appropriate for an initial release (i.e. are relatively easy to implement), but that shouldn't be the end of the builtin tests. I can imagine us writing bioinformatics specific tests using the <code>noodles</code> library for testing things like "is this output file a valid BAM?", "is this BAM coordinate sorted?", "is the output BAI file correctly matched to the output BAM?", and many many more such tests.</p>
<p>Another possibility we may even want to expose in an initial relase (so move from "Future possibilities" to a more prominent section of this RFC) would be custom tests. There are a couple of directions I've considered for this, and I think the most logical jumping off point would be to let users write shell scripts that are invoked with ENV vars set with the outputs of a task or workflow, and let them do whatever the heck tests they want to write in Bash and just ensure the exit code of the script is <code>0</code>. This seems to me the best ROI from an implementation standpoint. It would be pretty easy to set up and shell out, and would allow users to write arbitrarily complicated tests using whatever tools they want.</p>
<p>As stated in the "motivation" section, this proposal is ignoring end-to-end (or E2E) tests and is really just focused on enabling unit testing for CI purposes. Perhaps some of this could be re-used for an E2E API, but I have largely ignored that aspect. (Also I have lots of thoughts about what that might look like, but for brevity will not elaborate further.)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drafts"><a class="header" href="#drafts">Drafts</a></h1>
<p>The following are <em>candidate</em> RFCs that are being rendered for easy review. They are <em>not</em> accepted St. Jude Rust Labs RFCs. For more information please see <a href="https://github.com/stjude-rust-labs/rfcs/pulls">the associated pull request</a>.</p>
<ul>
<li><a href="https://stjude-rust-labs.github.io/rfcs/branches/rfcs/sprocket-test">rfcs/sprocket-test</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
